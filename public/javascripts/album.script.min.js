var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var f=b[c];if(f===a||Object.is(f,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
function makeNiceDate(a){var b=a.slice(0,4),c=a.slice(8,10);return"January February March April May June July August September October November December".split(" ")[a.slice(5,7)-1]+" "+c+", "+b}function escapeHtml(a){var b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","/":"&sol;","\\":"&#92;","{":"&#123;","}":"&#125;"};return a.replace(/[<>"'/\\{}]/g,function(a){return b[a]})}function removeExtraSpace(a){return a.replace(/\s\s+/g," ")}
function truncate(a,b){a=a.substr(0,b-1);return a.substr(0,a.lastIndexOf(" ")).replace(/(^[,\s]+)|([,\s]+$)/g,"")+"..."}function toTitleCase(a){return a.replace(/\b\w+/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}var albumID=window.location.pathname.replace("/album/",""),albumResult,selectedTags=[],userLists=[],listsWithAlbum=[];
function getAlbumDetails(a){$.ajax("/api/v1/album/albumid/"+albumID,{method:"GET",success:function(b){b.message?$.getJSON("/api/v1/apple/details/"+albumID,function(b){b.message?alert(b.message):(albumResult=b,populateAlbumPage(a))}):(albumResult=b,populateAlbumPage(a))}})}
function populateAlbumPage(a){$("#album-title").text(albumResult.title);$("#band-name").text(albumResult.artist);$("#album-cover").attr("src",albumResult.cover.replace("{w}",450).replace("{h}",450));$("#album-cover").on("load",function(){$("#album-cover-loader").hide()});$("#release-date span").text(makeNiceDate(albumResult.releaseDate));$("#record-company span").text(albumResult.recordCompany);$("#track-titles").html("");albumResult.songNames.forEach(function(a){$("#track-titles").append("<li>"+
a+"</li>")});$("#apple-album-id span").text(albumResult.appleAlbumID);$("#more-by-this-artist").click(function(a){a.preventDefault();$("#searchModal").modal("show");$("#search-modal-input").val(albumResult.artist);executeSearch(albumResult.artist)});$("#apple-music-link").click(function(a){a.preventDefault();return window.open(albumResult.appleURL,"_blank").location});populateTags();populateConnections();getListsWithAlbum(a);getUserLists();checkFavorites();a?(updateTagDisplay(a),updateConnectionDisplay(a)):
(0===$(".album-tag").length&&$("#current-tags").html('<div class="text-primary text-center"><small>There are currently no tags for this album. Log in to start adding your own tags!</small></div>'),0===$(".connection").length&&$("#connected-albums").html('<div class="text-primary text-center"><small>There are currently no connections for this album. Log in to start adding your own connections!</small><br/><br/></div>'))}
function checkFavorites(){userID?($("#favorite-title").show(),albumResult._id&&-1!==albumResult.favoritedBy.indexOf(userID)?$("#favorited-icon").html('<img src="../images/heart-liked.png" height="30" id="remove-from-favorites"><img src="../images/heart-unliked.png" height="30" id="add-to-favorites" style="display:none;">'):$("#favorited-icon").html('<img src="../images/heart-unliked.png" height="30" id="add-to-favorites"><img src="../images/heart-liked.png" height="30" id="remove-from-favorites" style="display:none;">'),
$("#remove-from-favorites").click(function(){removeFromFavorites();$("#remove-from-favorites").hide();$("#add-to-favorites").show()}),$("#add-to-favorites").click(function(){addToFavorites();$("#add-to-favorites").hide();$("#remove-from-favorites").show()})):$("#favorite-title").hide()}
function addToFavorites(){$.ajax("/api/v1/album/favorites/"+(albumResult._id||"new"),{method:"POST",contentType:"application/json",data:JSON.stringify({user:userID,albumData:albumResult}),success:function(a){a.message?alert(a.message):albumResult=a}})}function removeFromFavorites(){$.ajax("/api/v1/album/favorites/"+albumResult._id,{method:"DELETE",contentType:"application/json",data:JSON.stringify({user:userID}),success:function(a){a.message?alert(a.message):albumResult=a}})}
function getUserLists(){$.ajax({method:"GET",url:"/api/v1/list/user/"+userID,success:function(a){userLists=a.message?[]:a;populateUserLists()}})}function getListsWithAlbum(a){$.ajax({method:"GET",url:"/api/v1/list/album/"+albumResult.appleAlbumID,success:function(b){listsWithAlbum=b.message?[]:b;populateListsWithAlbum(a)}})}
function populateListsWithAlbum(a){$("#all-lists").html("");$(".list-message").remove();listsWithAlbum.forEach(function(a){if(!a.isPrivate){var b=a.displayName;""===b.trim&&(b="Unknown");a.user===userID?$("#all-lists").append('<li class="list my-list" data-creator="'+a.user+'"><a href="/list?type=userlist&id='+a._id+'">'+a.title+'</a><span class="text-secondary"> by: '+b+'</span><span class="remove-from-list-button" data-list-id="'+a._id+'">&#10005;</span></li>'):$("#all-lists").append('<li class="list other-list" data-creator="'+
a.user+'"><a href="/list?type=userlist&id='+a._id+'">'+a.title+'</a><span class="text-secondary"> by: '+b+"</span></li>")}});$(".remove-from-list-button").click(function(){removeFromList($(this).data("list-id"))});if(a)return updateListDisplay();0===$(".list").length&&($(".list-message").remove(),$("#all-lists").after('<div class="text-primary text-center list-message"><small>This album is not in any public user lists yet. Log in to get started working with lists!</small><br/><br/></div>'))}
function populateUserLists(){$("#list-options").html("");$("<option selected>Add to a list...</option>").appendTo("#list-options");userLists.forEach(function(a){$('<option value="'+a._id+'">'+a.title+"</option>").appendTo("#list-options")})}
function addToList(a){if(a){var b=listsWithAlbum.find(function(b){return b._id===a});if(b)return $("#list-options").get(0).selectedIndex=0,alert('This album is already in your "'+b.title+'" list.');$.ajax({method:"PUT",url:"/api/v1/list/"+a,contentType:"application/json",data:JSON.stringify({method:"add album",appleAlbumID:albumResult.appleAlbumID,title:albumResult.title,artist:albumResult.artist,releaseDate:albumResult.releaseDate,cover:albumResult.cover,genres:albumResult.genres}),success:function(a){a.message?
alert(a.message):(listsWithAlbum.push(a),populateListsWithAlbum(),$("#updateListModal").modal("hide"),$("#list-options").get(0).selectedIndex=0)}})}}
function addToNewList(a,b){var c=!0,d=userLists.find(function(b){return b.title.toUpperCase()===a.toUpperCase()});d&&(c=confirm('You already have a list called "'+d.title+'". Choose "ok" to create a new list, "cancel" to go back and add this album to an existing list.'));c&&(c=!1,$("#private-checkbox").is(":checked")&&(c=!0),a&&b&&$.ajax({method:"POST",url:"/api/v1/list/",contentType:"application/json",data:JSON.stringify({user:userID,displayName:b,title:a,isPrivate:c,albums:[albumResult]}),success:function(a){a.message?
alert(a.message):(userLists.push(a),listsWithAlbum.push(a),populateUserLists(),populateListsWithAlbum(),$("#updateListModal").modal("hide"),$("#new-list-title").val(""),$("#new-display-name").val(""))}}))}
function removeFromList(a){var b=listsWithAlbum.find(function(b){return b._id===a});confirm('Are you sure you want to remove this album from the "'+b.title+'" list? You cannot undo this operation.')&&$.ajax({method:"PUT",url:"/api/v1/list/"+b._id,contentType:"application/json",data:JSON.stringify({method:"remove album",appleAlbumID:albumResult.appleAlbumID,title:albumResult.title,artist:albumResult.artist,releaseDate:albumResult.releaseDate,cover:albumResult.cover}),success:function(a){a.message?
alert(a.message):(a=listsWithAlbum.indexOf(b),listsWithAlbum.splice(a,1),populateListsWithAlbum())}})}function updateListDisplay(){return"My Lists"===sessionStorage.getItem("lists")?displayMyLists():displayAllLists()}
function displayAllLists(){0===$("#lists-toggle").html().length?$("#lists-toggle").html('<img src="/images/toggle_on.png" id="show-all-lists" style="height:22px;margin-left:10px;"><img src="/images/toggle_off.png" id="show-my-lists" style="height:22px;margin-left:10px;display:none;">'):($("#show-my-lists").hide(),$("#show-all-lists").show());$(".my-list").show();$(".other-list").show();$("#list-title-modifier").html('All <span class="large-button-text">user </span>');$(".list-message").remove();0===
$(".list").length&&$("#all-lists").after('<div class="text-primary text-center list-message"><small>This album is not in any public user lists. Click "Add to a list" below to get started!</small><br/><br/></div>');$("#show-all-lists").click(function(){sessionStorage.setItem("lists","My Lists");updateListDisplay()})}
function displayMyLists(){0===$("#lists-toggle").html().length?$("#lists-toggle").html('<img src="/images/toggle_off.png" id="show-my-lists" style="height:22px;margin-left:10px;"><img src="/images/toggle_on.png" id="show-all-lists" style="height:22px;margin-left:10px;display:none;">'):($("#show-all-lists").hide(),$("#show-my-lists").show());$(".my-list").show();$(".other-list").hide();$("#list-title-modifier").text("Your ");$(".list-message").remove();0===$(".my-list").length&&$("#all-lists").after('<div class="text-primary text-center list-message"><small>You have added this album to any lists. Click "Add to a list" below to get started!</small><br/><br/></div>');
$("#show-my-lists").click(function(){sessionStorage.setItem("lists","All Lists");updateListDisplay()})}
function populateConnections(){if(albumResult.connectionObjects){$("#connected-albums").html("");for(var a=0;a<albumResult.connectionObjects.length;a++){var b=albumResult.connectionObjects[a];if(b.appleAlbumID!=albumResult.appleAlbumID){var c=b.cover.replace("{w}",105).replace("{h}",105),d=20<b.title.length?truncate(b.title,20):b.title;b.creator===userID?$("#connected-albums").append('<a href="/album/'+b.appleAlbumID+'" id="'+b.appleAlbumID+'" class="connection my-connection" data-creator="'+b.creator+
'"><img class="connection-cover" src="'+c+'" data-toggle="tooltip" data-placement="top" title="'+d+'" data-trigger="hover"><span class="delete-connection-button" data-connected-album-id="'+b.databaseID+'">&#10005;</span></a>'):$("#connected-albums").append('<a href="/album/'+b.appleAlbumID+'" id="'+b.appleAlbumID+'" class="connection other-connection" data-creator="'+b.creator+'"><img class="connection-cover" src="'+c+'" data-toggle="tooltip" data-placement="top" title="'+d+'" data-trigger="hover"></a>')}}$(".delete-connection-button").click(function(a){a.preventDefault();
deleteConnection($(this).data("connected-album-id"))});a=!1;"ontouchstart"in document.documentElement&&(a=!0);a||$('[data-toggle="tooltip"]').tooltip()}}
function addConnection(a){a&&a.title&&($.ajax("/api/v1/album/connections/"+(albumResult._id||"new"),{method:"POST",contentType:"application/json",data:JSON.stringify({albumOne:albumResult,albumTwo:a,creator:userID}),success:function(a){a.message?alert(a.message):(albumResult=a,populateConnections(),$("#updateConnectionModal").modal("hide"))}}),$("#add-connection-input").val(""))}var connectionSearchResults=[];
function populateConnectionModalResults(a){$("#connection-search-results").html("");$("#connection-loader").hide();if(a.albums&&0<a.albums.length){for(var b=0;b<a.albums.length;b++){var c=a.albums[b],d=b+1;connectionSearchResults.push(c);createConnectionModalCard(c,d);populateConnectionModalCard(c,d)}$("#connection-search-results").append('<div id="connection-search-modal-placeholder">&nbsp;</div>')}else $("#connection-search-results").after('<div id="no-results-message" class="text-primary mb-3" style="text-align:center;">It looks like no albums matched your search terms. Try a different search!</div>')}
function createConnectionModalCard(a,b){$("#connection-search-results").append('<div id="connectionModalCard'+b+'" class="search-modal-card" data-apple-album-id="'+a.appleAlbumID+'"><a class="search-modal-card-album-link" href=""><img class="search-modal-card-image" src="" alt=""><a/><div class="search-modal-card-body"><h4 class="search-modal-card-title"></h4><span class="search-modal-card-album"></span></div></div>')}
function populateConnectionModalCard(a,b){var c=32<a.artist.length?truncate(a.artist,32):a.artist,d=49<a.artist.length?truncate(a.artist,49):a.artist,e=44<a.title.length?truncate(a.title,44):a.title,f=66<a.title.length?truncate(a.title,66):a.title;$("#connectionModalCard"+b+" .search-modal-card-title").html('<span class="search-modal-card-large-artist">'+d+'</span><span class="search-modal-card-small-artist">'+c+"</span>");$("#connectionModalCard"+b+" .search-modal-card-album").html('<span class="search-modal-card-large-album">'+
f+'</span><span class="search-modal-card-small-album">'+e+"</span>");$("#connectionModalCard"+b+" .search-modal-card-image").attr("src",a.cover.replace("{w}",260).replace("{h}",260));$("#connectionModalCard"+b).click(function(a){a.preventDefault();var b=$(this).data("apple-album-id");a=connectionSearchResults.find(function(a){return a.appleAlbumID===b.toString()});addConnection(a)})}
function deleteConnection(a){confirm("Are you sure you want to delete a connection? You cannot undo this operation.")&&$.ajax("/api/v1/album/connections/"+albumResult._id,{method:"DELETE",contentType:"application/json",data:JSON.stringify({albumTwo:a.toString(),albumOne:albumResult._id.toString(),creator:userID}),success:function(a){a.message?alert(a.message):(albumResult=a,populateConnections(),updateConnectionDisplay())}})}
function updateConnectionDisplay(){return"My Connections"===sessionStorage.getItem("connections")?displayMyConnections():displayAllConnections()}
function displayAllConnections(){0===$("#connections-toggle").html().length?$("#connections-toggle").html('<img src="/images/toggle_on.png" id="show-all-connections" style="height:22px;margin-left:10px;"><img src="/images/toggle_off.png" id="show-my-connections" style="height:22px;margin-left:10px;display:none;">'):($("#show-my-connections").hide(),$("#show-all-connections").show());$(".my-connection").show();$(".other-connection").show();$("#connection-title-modifier").text("all users");$("#no-my-connections").remove();
$("#no-other-connections").remove();0===$(".connection").length&&$("#connected-albums").html('<div id="no-other-connections" class="text-primary text-center"><small>There are currently no connections for this album. Click "Add connections" below to get started!</small><br/><br/></div>');$("#show-all-connections").click(function(){sessionStorage.setItem("connections","My Connections");updateConnectionDisplay()})}
function displayMyConnections(){0===$("#connections-toggle").html().length?$("#connections-toggle").html('<img src="/images/toggle_off.png" id="show-my-connections" style="height:22px;margin-left:10px;"><img src="/images/toggle_on.png" id="show-all-connections" style="height:22px;margin-left:10px;display:none;">'):($("#show-all-connections").hide(),$("#show-my-connections").show());$(".my-connection").show();$(".other-connection").hide();$("#connection-title-modifier").text("you");$("#no-my-connections").remove();
$("#no-other-connections").remove();0===$(".my-connection").length&&$("#connected-albums").append('<div id="no-my-connections" class="text-primary text-center"><small>You have not created any connections for this album. Click "Add connections" below to get started!</small><br/><br/></div>');$("#show-my-connections").click(function(){sessionStorage.setItem("connections","All Connections");updateConnectionDisplay()})}
function populateTags(){clearTagArray();if(albumResult.tagObjects){$("#current-tags").html("");for(var a=0;a<albumResult.tagObjects.length;a++){var b=albumResult.tagObjects[a].tag,c=albumResult.tagObjects[a].creator,d=void 0;d=parseInt(b)?"tag_".concat(b).replace(/[^A-Z0-9]+/ig,""):b.replace(/[^A-Z0-9]+/ig,"");c===userID?$("#current-tags").append('<a href="" id="'+d+"-"+c+'" class="badge badge-light album-tag my-tag" data-creator="'+c+'" data-rawtag="'+escapeHtml(albumResult.tagObjects[a].tag)+'" data-custom-genre="'+
(albumResult.tagObjects[a].customGenre||!1)+'"><span>'+b+'</span><span class="delete-tag-button ml-1" data-tag-id="'+d+"-"+c+'">&#10005;</span></a>'):$("#current-tags").append('<a href="" id="'+d+"-"+c+'" class="badge badge-light album-tag other-tag" data-creator="'+c+'" data-rawtag="'+escapeHtml(albumResult.tagObjects[a].tag)+'" data-custom-genre="'+(albumResult.tagObjects[a].customGenre||!1)+'"><span>'+b+"</span></a>")}$(".delete-tag-button").click(function(){deleteTag($(this).data("tag-id"))});
$(".album-tag").click(function(a){a.preventDefault();selectTag(document.getElementById($(this).attr("id")),a)})}}function selectTag(a){a=document.getElementById(a.id);a.classList.toggle("badge-primary");a.classList.toggle("selected-tag");a.classList.toggle("badge-light");modifySelectedTags(escapeHtml(a.dataset.rawtag))}function modifySelectedTags(a){return-1===selectedTags.indexOf(a)?selectedTags.push(a):selectedTags.splice(selectedTags.indexOf(a),1)}
function fixShortTagsArray(){var a=[];albumResult.tagObjects.forEach(function(b){a.push(b.tag)});a.forEach(function(a){$.ajax({method:"POST",url:"/api/v1/album/tags/"+albumResult._id,data:JSON.stringify({tag:a,method:"fix short tags array"}),contentType:"application/json",success:function(a){a.message?alert(a.message):(albumResult=a,populateTags(),updateTagDisplay())}})})}
function deleteTag(a){var b=$("#"+a).data("creator"),c=$("#"+a).data("rawtag");a=$("#"+a).data("custom-genre");confirm('Are you sure you want to delete the "'+c+'" tag? You cannot undo this operation.')&&$.ajax("/api/v1/album/tags/"+albumResult._id,{method:"DELETE",contentType:"application/json",data:JSON.stringify({tag:escapeHtml(c.toString()),creator:b,customGenre:a}),success:function(a){a.message?alert(a.message):(albumResult=a,populateTags(),updateTagDisplay(),albumResult.tagObjects.length>albumResult.tags.length&&
fixShortTagsArray())}})}
function addTag(){var a=$("#add-tag-input").val().trim();if(a){if(a.includes("<")&&a.includes(">")||a.includes(".")||a.includes("{")||a.includes("}")){alert("Some characters are not allowed in tags, sorry!");$("#add-tag-input").val("");$("#custom-genre-checkbox").prop("checked",!1);return}if(30<a.length){alert('Tags cannot be longer than 30 characters. Check out the "All tags" page for some examples!');$("#add-tag-input").val("");$("#custom-genre-checkbox").prop("checked",!1);return}a=removeExtraSpace(toTitleCase(a)).trim();
a=escapeHtml(a);if(albumResult.tagObjects){var b=0;albumResult.tagObjects.forEach(function(c){c.tag===a&&c.creator===userID&&b++});if(0<b)return $("#add-tag-input").val(""),$("#custom-genre-checkbox").prop("checked",!1),alert('You already added the "'+a+'" tag to this album!');if(-1!=albumResult.tags.indexOf(a)){var c=confirm('Someone else already added the "'+a+'" tag to this album. Choose "ok" to add your tag, or "cancel" to avoid duplicates.');$("#add-tag-input").val("");$("#custom-genre-checkbox").prop("checked",
!1);if(!c)return}}c=$("#custom-genre-checkbox").is(":checked");$.ajax("/api/v1/album/tags/"+(albumResult._id||"new"),{method:"POST",contentType:"application/json",data:JSON.stringify({album:albumResult,creator:userID,tag:a,customGenre:c}),success:function(a){if(a.message)return alert(a.message);albumResult=a;populateTags();$("#tag-success").html("Added! &#10003;");setTimeout(function(){$("#tag-success").html("&nbsp;")},3E3)}})}else alert("Please enter a non-empty tag.");$("#add-tag-input").val("");
$("#custom-genre-checkbox").prop("checked",!1)}function toggleActiveInfoTab(a){$("#info-card .active").removeClass("active").addClass("inactive-info-tab");$(a).removeClass("inactive-info-tab").addClass("active");$(".info-card-body").hide();a=a.data("card");$("#"+a+"-info-card-body").show()}
function clearTagArray(){0<$(".selected-tag").length&&($(".selected-tag").toggleClass("badge-primary"),$(".selected-tag").toggleClass("badge-light"),$(".selected-tag").toggleClass("selected-tag"),selectedTags=[])}function updateTagDisplay(a){var b=!1;if(a||userID)b=!0;"My Tags"===sessionStorage.getItem("tags")&&b?displayMyTags(b):displayAllTags(b)}
function displayAllTags(a){a&&(0===$("#tags-toggle").html().length?$("#tags-toggle").html('<img src="/images/toggle_on.png" id="show-all-tags" style="height:22px;margin-left:10px;"><img src="/images/toggle_off.png" id="show-my-tags" style="height:22px;margin-left:10px;display:none;">'):($("#show-my-tags").hide(),$("#show-all-tags").show()));$(".my-tag").show();$(".other-tag").show();$("#tag-title-modifier").text("all users");$("#no-all-tags").remove();$("#no-my-tags").remove();0===$(".album-tag").length&&
$("#current-tags").html('<div id="no-all-tags" class="text-primary text-center"><small>There are currently no tags for this album. Click "Add tags" below to get started!</small></div>');a&&$("#show-all-tags").click(function(){sessionStorage.setItem("tags","My Tags");updateTagDisplay(a)})}
function displayMyTags(a){0===$("#tags-toggle").html().length?$("#tags-toggle").html('<img src="/images/toggle_off.png" id="show-my-tags" style="height:22px;margin-left:10px;"><img src="/images/toggle_on.png" id="show-all-tags" style="height:22px;margin-left:10px;display:none;">'):($("#show-all-tags").hide(),$("#show-my-tags").show());$(".my-tag").show();$(".other-tag").hide();$("#tag-title-modifier").text("you");$("#no-all-tags").remove();$("#no-my-tags").remove();0===$(".my-tag").length&&$("#current-tags").append('<div id="no-my-tags" class="text-primary text-center"><small>You have not created any tags for this album. Click "Add tags" below to get started!</small></div>');
$("#show-my-tags").click(function(){sessionStorage.setItem("tags","All Tags");updateTagDisplay(a)})}$("#favorites-link").click(function(){return window.open(window.location.protocol+"//"+window.location.host+"/myfavorites","_blank").location});$("#new-list-title").keyup(function(a){13===a.keyCode&&$("#add-to-new-list-button").click()});$("#new-display-name").keyup(function(a){13===a.keyCode&&$("#add-to-new-list-button").click()});$("#list-options").keyup(function(a){13===a.keyCode&&$("#add-to-list-button").click()});
$("#search-for-second-album").click(function(){return window.open(window.location.protocol+"//"+window.location.host+"/search","_blank").location});$("#info-card .nav-link").click(function(a){a.preventDefault();toggleActiveInfoTab($(this))});$("#tag-search-button").click(function(a){a.preventDefault();0<selectedTags.length?(a=new URL(document.location),a.pathname="/list",a.searchParams.set("type","tagsearch"),a.searchParams.set("search",selectedTags),window.location=a.href):alert("Select one or more tags to preform a tag search")});
$("#clear-tag-button").click(function(a){a.preventDefault();clearTagArray()});$("#add-tag-button").click(addTag);$("#add-tag-input").keyup(function(a){13===a.keyCode&&$("#add-tag-button").click()});$("#add-connection-button").click(function(){var a=$("#add-connection-input").val().trim();$("#no-results-message").remove();$("#connection-search-results").html("");$("#connection-loader").show();executeSearch(a,"connection")});$("#add-connection-input").keyup(function(a){13===a.keyCode&&$("#add-connection-button").click()});
$("#add-to-list-button").click(function(){var a=document.getElementById("list-options");a=a[a.selectedIndex].value;"Add to a list..."!==a&&addToList(a)});
$("#add-to-new-list-button").click(function(){var a=document.getElementById("new-list-title").value.trim(),b=document.getElementById("new-display-name").value.trim()||"Unknown";if(!a)return alert("All lists require a title!");if(a.includes("<")&&a.includes(">")||a.includes(".")||a.includes("{")||a.includes("}"))return $("#new-list-title").val(""),alert("Some characters are not allowed in tags, sorry!");if(b.includes("<")&&b.includes(">")||b.includes(".")||b.includes("{")||b.includes("}"))return $("#new-display-name").val(""),
alert("Some characters are not allowed in tags, sorry!");if("MY FAVORITES"===a.toUpperCase())return $("#new-list-title").val(""),alert("'My Favorites' is a reserved list name. Give the existing 'My Favorites' functionality a shot or choose a different title.");if(60<a.length)return alert("List titles must be shorter than 60 characters in length.");if(30<b.length)return alert("Display names must be shorter than 30 characters in length.");addToNewList(escapeHtml(a),escapeHtml(b));document.getElementById("new-display-name").value=
"";document.getElementById("new-list-title").value=""});$("#custom-genre-checkbox-text").click(function(){$("#custom-genre-checkbox").click()});$(document).ready(function(){var a=!1;"ontouchstart"in document.documentElement&&(a=!0);a&&(a=document.getElementById("connection-search-results"),a.style.paddingBottom="0px",a.style.overflowX="scroll")});
function userIsLoggedIn(){$(".hide_when_logged_in").addClass("hide_me");$(".hide_when_logged_out").removeClass("hide_me");$("#full_menu_login_logout_container").show();$("#login_button").hide();$("#full_menu_login_button").hide();$("#logout_button").show();$("#full_menu_logout_button").show();$(".info-card-login-button").hide();$("#tag-update-button").show();$("#connection-update-button").show();$("#list-update-button").show();$("#favorite-title").show();getAlbumDetails(!0)}
function userIsLoggedOut(){$(".hide_when_logged_out").addClass("hide_me");$(".hide_when_logged_in").removeClass("hide_me");$("#full_menu_login_logout_container").show();$("#login_button").show();$("#full_menu_login_button").show();$("#logout_button").hide();$("#full_menu_logout_button").hide();$(".info-card-login-button").show();$("#tag-update-button").hide();$("#connection-update-button").hide();$("#list-update-button").hide();$("#favorite-title").hide();getAlbumDetails(!1)}
var config={apiKey:"AIzaSyAoadL6l7wVMmMcjqqa09_ayEC8zwnTyrc",authDomain:"album-tags-v1d1.firebaseapp.com",projectId:"album-tags-v1d1"},defaultApp=firebase.initializeApp(config);firebase.auth().onAuthStateChanged(function(a){a&&(userID=firebase.auth().currentUser.uid,userIsLoggedIn());a||(userID=!1,userIsLoggedOut())});var userID;
function logIn(){firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(function(){var a=new firebase.auth.GoogleAuthProvider;return firebase.auth().signInWithPopup(a)}).then(function(a){userID=user.uid;userIsLoggedIn()}).catch(function(a){})}function logOut(){firebase.auth().signOut().then(function(){location.reload()}).catch(function(a){})}document.getElementById("login_button").addEventListener("click",logIn);
document.getElementById("full_menu_login_button").addEventListener("click",logIn);document.getElementById("logout_button").addEventListener("click",logOut);document.getElementById("full_menu_logout_button").addEventListener("click",logOut);$(".info-card-login-button").on("click",logIn);
