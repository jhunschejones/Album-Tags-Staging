var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in c||(c[d]={});c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof d?a:new d(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var e=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){e(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(k){this.asyncThrow_(k)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var d=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}};d.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};d.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof d)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};d.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(l){this.reject_(l);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};d.prototype.reject_=function(a){this.settle_(2,a)};d.prototype.fulfill_=function(a){this.settle_(1,a)};d.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};d.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;d.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};d.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(k){c.reject(k)}};d.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{e(a(b))}catch(m){g(m)}}:b}var e,g,f=new d(function(a,b){e=a;g=b});this.callWhenSettled_(c(a,e),c(b,g));return f};
d.prototype.catch=function(a){return this.then(void 0,a)};d.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};d.resolve=c;d.reject=function(a){return new d(function(b,c){c(a)})};d.race=function(a){return new d(function(b,d){for(var e=$jscomp.makeIterator(a),g=e.next();!g.done;g=e.next())c(g.value).callWhenSettled_(b,
d)})};d.all=function(a){var b=$jscomp.makeIterator(a),e=b.next();return e.done?c([]):new d(function(a,d){function g(b){return function(c){f[b]=c;h--;0==h&&a(f)}}var f=[],h=0;do f.push(void 0),h++,c(e.value).callWhenSettled_(g(f.length-1),d),e=b.next();while(!e.done)})};return d},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};
$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var e=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(e);if(!e.done)return this.context_.stop_(),e;var d=e.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,d);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(b){return a.next(b)}function c(b){return a.throw(b)}return new Promise(function(e,d){function f(a){a.done?e(a.value):Promise.resolve(a.value).then(b,c).then(f,d)}f(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var f=a[d];if(b.call(c,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var d=b.length;c=c||0;for(0>c&&(c=Math.max(c+d,0));c<d;c++){var f=b[c];if(f===a||Object.is(f,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
function makeNiceDate(a){var b=a.slice(0,4),c=a.slice(8,10);return"January February March April May June July August September October November December".split(" ")[a.slice(5,7)-1]+" "+c+", "+b}function removeSelectedElement(a){if("."===a[0]){a=document.querySelectorAll(a);for(var b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b])}else"#"===a[0]?(a=document.getElementById(a.substring(1)))&&a.parentNode.removeChild(a):console.error("removeSelectedElement() was passed an invalid selector")}
function addClassEventListener(a,b,c){a=document.getElementsByClassName(a);for(var e=0;e<a.length;e++)a[e].addEventListener(b,c)}function stringToNode(a){var b=document.createElement("template");b.innerHTML=a;return b.content.firstChild}function showClass(a){a=document.getElementsByClassName(a);for(var b=0;b<a.length;b++)a[b].classList.remove("hide_me")}function hideClass(a){a=document.getElementsByClassName(a);for(var b=0;b<a.length;b++)a[b].classList.add("hide_me")}
function escapeHtml(a){var b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","/":"&sol;","\\":"&#92;","{":"&#123;","}":"&#125;"};return a.replace(/[<>"'/\\{}]/g,function(a){return b[a]})}function removeExtraSpaces(a){return a.replace(/\s\s+/g," ").trim()}function truncate(a,b){a=a.substr(0,b-1);return a.substr(0,a.lastIndexOf(" ")).replace(/(^[,\s]+)|([,\s]+$)/g,"")+"..."}function toTitleCase(a){return a.replace(/\b\w+/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}
var app=new Vue({el:"#app",data:{userID:!1,album:{},userLists:[],selectedTags:[],connectionSearchResults:[],coverLoaded:!1},computed:{unescapedRecordCompany:function(){return this.album.recordCompany.replace("&amp;","&")},niceReleaseDate:function(){return makeNiceDate(this.album.releaseDate)},coverImage:function(){return this.album.cover.replace("{w}",450).replace("{h}",450)}},methods:{moreByThisArtist:function(a){a.preventDefault();(new Modal(document.getElementById("searchModal"))).show();document.getElementById("search-modal-input").value=
app.album.artist;executeSearch(app.album.artist)},viewInAppleMusic:function(a){a.preventDefault();return window.open(app.album.appleURL,"_blank").location}}}),albumID=window.location.pathname.replace("/album/","");
function getAlbumDetails(a){var b,c,e,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){switch(f.nextAddress){case 1:return f.yield(fetch("/api/v1/album/"+albumID),2);case 2:b=f.yieldResult;if(!b.ok)throw Error(b.statusText);return f.yield(b.json(),3);case 3:c=f.yieldResult;if(!c.message||"No album found"!==c.message.slice(0,14)){app.album=c;populateAlbumPage(a);f.jumpTo(0);break}return f.yield(fetch("/api/v1/apple/details/"+albumID),5);case 5:e=f.yieldResult;if(!e.ok)throw Error(e.statusText);
return f.yield(e.json(),6);case 6:d=f.yieldResult;if(d.message)return f.return(alert(d.message));app.album=d;populateAlbumPage(a);f.jumpToEnd()}})}
function populateAlbumPage(a){populateTags();populateConnections();getUserLists();populateListsWithAlbum(a);a?(updateTagDisplay(a),updateConnectionDisplay(a)):(app.album.tags&&0!==app.album.tags.length||document.getElementById("current-tags").appendChild(stringToNode('<div class="text-primary text-center"><small>There are currently no tags for this album. Log in to start adding your own tags!</small></div>')),app.album.connections&&0!==app.album.connections.length||document.getElementById("connected-albums").appendChild(stringToNode('<div class="text-primary text-center"><small>There are currently no connections for this album. Log in to start adding your own connections!</small><br/><br/></div>')))}
function addToFavorites(){var a,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return app.album.favorites&&app.album.favorites.find(function(a){return a.userID===app.userID})?(populateUserLists(),c.return(alert('This album is already in your "My Favorites" list.'))):c.yield(fetch("/api/v1/favorite",{method:"post",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:app.userID,album:app.album})}),2);if(3!=c.nextAddress){a=
c.yieldResult;if(!a.ok)throw Error(a.statusText);return c.yield(a.json(),3)}b=new Modal(document.getElementById("updateListModal"));b.hide();app.album.favorites||(app.album.favorites=[]);app.album.favorites.push({userID:app.userID});populateListsWithAlbum();updateListDisplay();document.getElementById("list-options").selectedIndex=0;c.jumpToEnd()})}
function removeFromFavorites(){var a,b,c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return(a=confirm("Are you sure you want to remove this album from the 'My Favorites' list? You cannot undo this operation."))?e.yield(fetch("/api/v1/favorite",{method:"delete",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:app.userID,appleAlbumID:app.album.appleAlbumID,returnData:"album"})}),3):e.jumpTo(0);if(4!=e.nextAddress){b=
e.yieldResult;if(!b.ok)throw Error(b.statusText);return e.yield(b.json(),4)}c=e.yieldResult;app.album=c;populateListsWithAlbum();updateListDisplay();e.jumpToEnd()})}
function getUserLists(){var a,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return c.yield(fetch("/api/v1/list/user/"+app.userID),2);if(3!=c.nextAddress){a=c.yieldResult;if(!a.ok)throw Error(a.statusText);return c.yield(a.json(),3)}b=c.yieldResult;app.userLists=b.message?[]:b;populateUserLists();c.jumpToEnd()})}
function populateListsWithAlbum(a){document.getElementById("all-lists").innerHTML="";removeSelectedElement(".list-message");app.userID&&app.album.favorites&&app.album.favorites.find(function(a){return a.userID===app.userID})&&document.getElementById("all-lists").appendChild(stringToNode('<li class="list my-list" data-creator="'+app.userID+'"><a href="/list?type=myfavorites">&#9825; My Favorites</a><span class="text-secondary"> by: You!</span><span class="remove-from-list-button" data-list-type="myfavorites">&#10005;</span></li>'));
app.album.lists&&(app.album.lists=app.album.lists.sort(function(a,c){return a.title>c.title?1:-1}),app.album.lists.forEach(function(a){if(!a.isPrivate){var b=a.displayName;b&&""!==b.trim||(b="Unknown");a.user===app.userID?document.getElementById("all-lists").appendChild(stringToNode('<li class="list my-list" data-creator="'+a.user+'"><a href="/list?type=userlist&id='+a.id+'">'+a.title+'</a><span class="text-secondary"> by: '+b+'</span><span class="remove-from-list-button" data-list-id="'+a.id+'" data-list-type="userlist">&#10005;</span></li>')):
document.getElementById("all-lists").appendChild(stringToNode('<li class="list other-list" data-creator="'+a.user+'"><a href="/list?type=userlist&id='+a.id+'">'+a.title+'</a><span class="text-secondary" data-list-type="userlist"> by: '+b+"</span></li>"))}}));addClassEventListener("remove-from-list-button","click",function(){if("myfavorites"===this.dataset.listType)return removeFromFavorites();removeFromList(parseInt(this.dataset.listId))});if(a)return updateListDisplay();0===document.getElementsByClassName("list").length&&
(removeSelectedElement(".list-message"),document.getElementById("all-lists").appendChild(stringToNode('<div class="text-primary text-center list-message"><small>This album is not in any public user lists yet. Log in to get started working with lists!</small><br/><br/></div>')))}
function populateUserLists(){document.getElementById("list-options").innerHTML="";document.getElementById("list-options").appendChild(stringToNode("<option selected>Add to a list...</option>"));document.getElementById("list-options").appendChild(stringToNode('<option value="myfavorites">&#9825; My Favorites</option>'));app.userLists=app.userLists.sort(function(a,b){return a.title>b.title?1:-1});app.userLists.forEach(function(a){document.getElementById("list-options").appendChild(stringToNode('<option value="'+
a.id+'">'+a.title+"</option>"))})}
function addToList(a){var b,c,e,d,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress){if(!a)return g.jumpTo(0);if("myfavorites"===a)return g.return(addToFavorites());if(app.album.lists&&(b=app.album.lists.find(function(b){return b.id===a})))return document.getElementById("list-options").selectedIndex=0,g.return(alert('This album is already in your "'+b.title+'" list.'));c={method:"add album",appleAlbumID:app.album.appleAlbumID,title:app.album.title,artist:app.album.artist,
releaseDate:app.album.releaseDate,cover:app.album.cover,genres:app.album.genres,songNames:app.album.songNames,appleURL:app.album.appleURL,recordCompany:app.album.recordCompany};return g.yield(fetch("/api/v1/list/"+a,{method:"put",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),3)}if(4!=g.nextAddress){e=g.yieldResult;if(!e.ok)throw Error(e.statusText);return g.yield(e.json(),4)}d=g.yieldResult;app.album.lists||(app.album.lists=[]);app.album.lists.push(d);
populateListsWithAlbum();updateListDisplay();f=new Modal(document.getElementById("updateListModal"));f.hide();document.getElementById("list-options").selectedIndex=0;g.jumpToEnd()})}
function addToNewList(a,b){var c,e,d,f,g,h,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress){c=!0;(e=app.userLists.find(function(b){return b.title.toUpperCase()===a.toUpperCase()}))&&(c=confirm('You already have a list called "'+e.title+'". Choose "ok" to create a new list, "cancel" to go back and add this album to an existing list.'));if(!c)return k.jumpTo(0);d=!1;document.getElementById("private-checkbox")&&document.getElementById("private-checkbox").checked&&
(d=!0);if(!a||!b)return k.jumpTo(0);f={user:app.userID,displayName:b,title:a,isPrivate:d,albums:[app.album]};return k.yield(fetch("/api/v1/list/",{method:"post",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),4)}if(5!=k.nextAddress){g=k.yieldResult;if(!g.ok)throw Error(g.statusText);return k.yield(g.json(),5)}h=k.yieldResult;h.message?alert(h.message):(app.userLists.push(h),app.album.lists||(app.album.lists=[]),app.album.lists.push(h),populateUserLists(),
populateListsWithAlbum(),updateListDisplay(),l=new Modal(document.getElementById("updateListModal")),l.hide(),document.getElementById("new-list-title").value="",document.getElementById("new-display-name").value="");k.jumpToEnd()})}
function removeFromList(a){var b,c,e,d,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress){b=app.album.lists.find(function(b){return b.id===a});c=confirm('Are you sure you want to remove this album from the "'+b.title+'" list? You cannot undo this operation.');if(!c)return g.jumpTo(0);e={method:"remove album",appleAlbumID:app.album.appleAlbumID,title:app.album.title,artist:app.album.artist,releaseDate:app.album.releaseDate,cover:app.album.cover};return g.yield(fetch("/api/v1/list/"+
b.id,{method:"post",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),3)}if(4!=g.nextAddress){d=g.yieldResult;if(!d.ok)throw Error(d.statusText);return g.yield(d.json(),4)}f=app.album.lists.indexOf(b);app.album.lists.splice(f,1);populateListsWithAlbum();updateListDisplay();g.jumpToEnd()})}function updateListDisplay(){return"My Lists"===sessionStorage.getItem("lists")?displayMyLists():displayAllLists()}
function displayAllLists(){0===document.getElementById("lists-toggle").innerHTML.length?document.getElementById("lists-toggle").innerHTML='<img src="/images/toggle_on.png" id="show-all-lists" class="toggle-switch" style="height:22px;margin-left:10px;"><img src="/images/toggle_off.png" id="show-my-lists" class="hide_me toggle-switch" style="height:22px;margin-left:10px;">':(document.getElementById("show-my-lists").classList.add("hide_me"),document.getElementById("show-all-lists").classList.remove("hide_me"));
showClass("my-list");showClass("other-list");document.getElementById("list-title-modifier").innerHTML='All <span class="large-button-text">user </span>';removeSelectedElement(".list-message");0===document.getElementsByClassName("list").length&&document.getElementById("all-lists").parentNode.insertBefore(stringToNode('<div class="text-primary text-center list-message"><small>This album is not in any public user lists. Click "Add to a list" below to get started!</small><br/><br/></div>'),document.getElementById("all-lists").nextSibling);
document.getElementById("show-all-lists").addEventListener("click",function(){sessionStorage.setItem("lists","My Lists");updateListDisplay()})}
function displayMyLists(){0===document.getElementById("lists-toggle").innerHTML.length?document.getElementById("lists-toggle").innerHTML='<img src="/images/toggle_off.png" id="show-my-lists" class="toggle-switch" style="height:22px;margin-left:10px;"><img src="/images/toggle_on.png" id="show-all-lists" class="hide_me toggle-switch" style="height:22px;margin-left:10px;">':(document.getElementById("show-all-lists").classList.add("hide_me"),document.getElementById("show-my-lists").classList.remove("hide_me"));
for(var a=document.getElementsByClassName("my-list"),b=0;b<a.length;b++)a[b].classList.remove("hide_me");a=document.getElementsByClassName("other-list");for(b=0;b<a.length;b++)a[b].classList.add("hide_me");document.getElementById("list-title-modifier").innerText="Your ";removeSelectedElement(".list-message");0===document.getElementsByClassName("my-list").length&&document.getElementById("all-lists").parentNode.insertBefore(stringToNode('<div class="text-primary text-center list-message"><small>You have not added this album to any lists. Click "Add to a list" below to get started!</small><br/><br/></div>'),
document.getElementById("all-lists").nextSibling);document.getElementById("show-my-lists").addEventListener("click",function(){sessionStorage.setItem("lists","All Lists");updateListDisplay()})}
function populateConnections(){if(app.album.connections){document.getElementById("connected-albums").innerHTML="";for(var a=0;a<app.album.connections.length;a++){var b=app.album.connections[a];if(b.appleAlbumID!=app.album.appleAlbumID){var c=b.cover.replace("{w}",105).replace("{h}",105),e=20<b.title.length?truncate(b.title,20):b.title;b.creator===app.userID?document.getElementById("connected-albums").appendChild(stringToNode('<a href="/album/'+b.appleAlbumID+'" id="'+b.appleAlbumID+'" class="connection my-connection" data-creator="'+
b.creator+'"><img class="connection-cover" src="'+c+'" data-toggle="tooltip" data-placement="top" title="'+e+'" data-trigger="hover"><span class="delete-connection-button" data-connected-album-id="'+b.appleAlbumID+'">&#10005;</span></a>')):document.getElementById("connected-albums").appendChild(stringToNode('<a href="/album/'+b.appleAlbumID+'" id="'+b.appleAlbumID+'" class="connection other-connection" data-creator="'+b.creator+'"><img class="connection-cover" src="'+c+'" data-toggle="tooltip" data-placement="top" title="'+
e+'" data-trigger="hover"></a>'))}}addClassEventListener("delete-connection-button","click",function(a){a.preventDefault();deleteConnection(this.dataset.connectedAlbumId)});a=!1;"ontouchstart"in document.documentElement&&(a=!0);if(!a)for(a=document.querySelectorAll("[title]"),b=0;b<a.length;b++)new Tooltip(a[b],{placement:"top",animation:"hide",delay:10})}}
function addConnection(a){var b,c,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return a&&a.title?d.yield(fetch("/api/v1/connection",{method:"post",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({albumOne:app.album,albumTwo:a,creator:app.userID})}),3):d.jumpTo(0);if(4!=d.nextAddress){b=d.yieldResult;if(!b.ok)throw Error(b.statusText);return d.yield(b.json(),4)}c=d.yieldResult;e=new Modal(document.getElementById("updateConnectionModal"));
e.hide();app.album.connections=c;populateConnections();updateConnectionDisplay();document.getElementById("add-connection-input").value="";d.jumpToEnd()})}
function populateConnectionModalResults(a){document.getElementById("connection-search-results").innerHTML="";document.getElementById("connection-loader").classList.add("hide_me");if(a.albums&&0<a.albums.length){for(var b=0;b<a.albums.length;b++){var c=a.albums[b],e=b+1;app.connectionSearchResults.push(c);createConnectionModalCard(c,e);populateConnectionModalCard(c,e)}document.getElementById("connection-search-results").appendChild(stringToNode('<div id="connection-search-modal-placeholder">&nbsp;</div>'))}else document.getElementById("connection-search-results").parentNode.insertBefore(stringToNode('<div id="no-results-message" class="text-primary mb-3" style="text-align:center;">It looks like no albums matched your search terms. Try a different search!</div>'),
document.getElementById("connection-search-results").nextSibling)}
function createConnectionModalCard(a,b){document.getElementById("connection-search-results").appendChild(stringToNode('<div id="connectionModalCard'+b+'" class="search-modal-card" data-apple-album-id="'+a.appleAlbumID+'"><a class="search-modal-card-album-link" href=""><img class="search-modal-card-image" src="" alt=""><a/><div class="search-modal-card-body"><h4 class="search-modal-card-title"></h4><span class="search-modal-card-album"></span></div></div>'))}
function populateConnectionModalCard(a,b){var c=32<a.artist.length?truncate(a.artist,32):a.artist,e=49<a.artist.length?truncate(a.artist,49):a.artist,d=44<a.title.length?truncate(a.title,44):a.title,f=66<a.title.length?truncate(a.title,66):a.title;document.querySelector("#connectionModalCard"+b+" .search-modal-card-title").innerHTML='<span class="search-modal-card-large-artist">'+e+'</span><span class="search-modal-card-small-artist">'+c+"</span>";document.querySelector("#connectionModalCard"+b+" .search-modal-card-album").innerHTML=
'<span class="search-modal-card-large-album">'+f+'</span><span class="search-modal-card-small-album">'+d+"</span>";document.querySelector("#connectionModalCard"+b+" .search-modal-card-image").src=a.cover.replace("{w}",260).replace("{h}",260);document.getElementById("connectionModalCard"+b).addEventListener("click",function(a){a.preventDefault();var b=this.dataset.appleAlbumId;a=app.connectionSearchResults.find(function(a){return a.appleAlbumID===b.toString()});addConnection(a)})}
function deleteConnection(a){var b,c,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return(b=confirm("Are you sure you want to delete a connection? You cannot undo this operation."))?d.yield(fetch("/api/v1/connection",{method:"delete",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({albumTwo:a.toString(),albumOne:app.album.appleAlbumID.toString(),creator:app.userID})}),3):d.jumpTo(0);if(4!=d.nextAddress){c=d.yieldResult;
if(!c.ok)throw Error(c.statusText);return d.yield(c.json(),4)}e=d.yieldResult;app.album.connections=e;populateConnections();updateConnectionDisplay();d.jumpToEnd()})}function updateConnectionDisplay(){return"My Connections"===sessionStorage.getItem("connections")?displayMyConnections():displayAllConnections()}
function displayAllConnections(){0===document.getElementById("connections-toggle").innerHTML.length?document.getElementById("connections-toggle").innerHTML='<img src="/images/toggle_on.png" id="show-all-connections" class="toggle-switch" style="height:22px;margin-left:10px;"><img src="/images/toggle_off.png" id="show-my-connections" class="hide_me toggle-switch" style="height:22px;margin-left:10px;">':(document.getElementById("show-my-connections").classList.add("hide_me"),document.getElementById("show-all-connections").classList.remove("hide_me"));
showClass("my-connection");showClass("other-connection");document.getElementById("connection-title-modifier").innerText="all users";removeSelectedElement(".no-my-connections");removeSelectedElement(".no-other-connections");0===document.getElementsByClassName("connection").length&&(document.getElementById("connected-albums").innerHTML='<div class="no-other-connections text-primary text-center"><small>There are currently no connections for this album. Click "Add connections" below to get started!</small><br/><br/></div>');
document.getElementById("show-all-connections").addEventListener("click",function(){sessionStorage.setItem("connections","My Connections");updateConnectionDisplay()})}
function displayMyConnections(){0===document.getElementById("connections-toggle").innerHTML.length?document.getElementById("connections-toggle").innerHTML='<img src="/images/toggle_off.png" id="show-my-connections" class="toggle-switch" style="height:22px;margin-left:10px;"><img src="/images/toggle_on.png" id="show-all-connections" class="hide_me toggle-switch" style="height:22px;margin-left:10px;">':(document.getElementById("show-all-connections").classList.add("hide_me"),document.getElementById("show-my-connections").classList.remove("hide_me"));
showClass("my-connection");hideClass("other-connection");document.getElementById("connection-title-modifier").innerText="you";removeSelectedElement(".no-my-connections");removeSelectedElement(".no-other-connections");0===document.getElementsByClassName("my-connection").length&&document.getElementById("connected-albums").appendChild(stringToNode('<div class="no-my-connections text-primary text-center"><small>You have not created any connections for this album. Click "Add connections" below to get started!</small><br/><br/></div>'));
document.getElementById("show-my-connections").addEventListener("click",function(){sessionStorage.setItem("connections","All Connections");updateConnectionDisplay()})}
function populateTags(){clearTagArray();if(app.album.tagObjects){app.album.tagObjects=app.album.tagObjects.sort(function(a,b){return a.text>b.text?1:-1});document.getElementById("current-tags").innerHTML="";for(var a=0;a<app.album.tagObjects.length;a++){var b=app.album.tagObjects[a].text,c=app.album.tagObjects[a].creator,e=void 0;e=parseInt(b)?"tag_".concat(b).replace(/[^A-Z0-9]+/ig,""):b.replace(/[^A-Z0-9]+/ig,"");c===app.userID?document.getElementById("current-tags").appendChild(stringToNode('<a href="" id="'+
e+"-"+c+'" class="badge badge-light album-tag my-tag" data-creator="'+c+'" data-rawtag="'+escapeHtml(app.album.tagObjects[a].text)+'" data-custom-genre="'+(app.album.tagObjects[a].customGenre||!1)+'"><span>'+b+'</span><span class="delete-tag-button ml-1" data-tag-id="'+e+"-"+c+'">&#10005;</span></a>')):document.getElementById("current-tags").appendChild(stringToNode('<a href="" id="'+e+"-"+c+'" class="badge badge-light album-tag other-tag" data-creator="'+c+'" data-rawtag="'+escapeHtml(app.album.tagObjects[a].text)+
'" data-custom-genre="'+(app.album.tagObjects[a].customGenre||!1)+'"><span>'+b+"</span></a>"))}addClassEventListener("delete-tag-button","click",function(){deleteTag(this.dataset.tagId)});addClassEventListener("album-tag","click",function(a){a.preventDefault();selectTag(document.getElementById(this.id),a)})}}
function selectTag(a){a=document.getElementById(a.id);a.classList.toggle("badge-primary");a.classList.toggle("selected-tag");a.classList.toggle("badge-light");modifySelectedTags(escapeHtml(a.dataset.rawtag))}function modifySelectedTags(a){return-1===app.selectedTags.indexOf(a)?app.selectedTags.push(a):app.selectedTags.splice(app.selectedTags.indexOf(a),1)}
function deleteTag(a){var b,c,e,d,f,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){if(1==h.nextAddress)return b=document.getElementById(""+a).dataset.creator,c=document.getElementById(""+a).dataset.customGenre,e=document.getElementById(""+a).dataset.rawtag,(d=confirm('Are you sure you want to delete the "'+e+'" tag? You cannot undo this operation.'))?h.yield(fetch("/api/v1/tag/",{method:"delete",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:escapeHtml(e.toString()),
creator:b,appleAlbumID:app.album.appleAlbumID,customGenre:c})}),3):h.jumpTo(0);if(4!=h.nextAddress){f=h.yieldResult;if(!f.ok)throw Error(f.statusText);return h.yield(f.json(),4)}g=h.yieldResult;g.message?alert(g.message):(app.album=g,populateTags(),updateTagDisplay());h.jumpToEnd()})}
function addTag(){var a,b,c,e,d,f,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(h){switch(h.nextAddress){case 1:a=document.getElementById("add-tag-input").value.trim();if(!a){alert("Please enter a non-empty tag.");h.jumpTo(2);break}if(a.includes("<")&&a.includes(">")||a.includes(".")||a.includes("{")||a.includes("}"))return alert("Some characters are not allowed in tags, sorry!"),document.getElementById("add-tag-input").value="",document.getElementById("custom-genre-checkbox").checked=
!1,h.return();if(30<a.length)return alert('Tags cannot be longer than 30 characters. Check out the "All tags" page for some examples!'),document.getElementById("add-tag-input").value="",document.getElementById("custom-genre-checkbox").checked=!1,h.return();a=removeExtraSpaces(toTitleCase(a));a=escapeHtml(a);if(app.album.tagObjects){b=0;app.album.tagObjects.forEach(function(c){c.text===a&&c.creator===app.userID&&b++});if(0<b)return document.getElementById("add-tag-input").value="",document.getElementById("custom-genre-checkbox").checked=
!1,h.return(alert('You already added the "'+a+'" tag to this album!'));if(c=app.album.tagObjects.find(function(b){return b.text===a}))if(e=confirm('Someone else already added the "'+a+'" tag to this album. Choose "ok" to add your tag, or "cancel" to avoid duplicates.'),document.getElementById("add-tag-input").value="",document.getElementById("custom-genre-checkbox").checked=!1,!e)return h.return()}d=document.getElementById("custom-genre-checkbox").checked;return h.yield(fetch("/api/v1/tag/",{method:"post",
credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({album:app.album,creator:app.userID,tag:a,customGenre:d})}),3);case 3:f=h.yieldResult;if(!f.ok)throw Error(f.statusText);return h.yield(f.json(),4);case 4:g=h.yieldResult;if(g.message)return h.return(alert(g.message));g.songNames&&g.genres||(g.songNames=app.album.songNames,g.genres=app.album.genres);app.album=g;populateTags();updateTagDisplay();document.getElementById("tag-success").innerHTML="Added! &#10003;";
setTimeout(function(){document.getElementById("tag-success").innerHTML="&nbsp;"},3E3);case 2:document.getElementById("add-tag-input").value="",document.getElementById("custom-genre-checkbox").checked=!1,h.jumpToEnd()}})}
function toggleActiveInfoTab(a){var b=document.querySelector("#info-card .active");b.classList.remove("active");b.classList.add("inactive-info-tab");document.getElementById(a).classList.remove("inactive-info-tab");document.getElementById(a).classList.add("active");hideClass("info-card-body");a=document.getElementById(a).dataset.card;document.getElementById(a+"-info-card-body").classList.remove("hide_me")}
function clearTagArray(){if(0<document.getElementsByClassName("selected-tag").length)for(var a=document.getElementsByClassName("selected-tag"),b=0;b<a.length;b++){var c=a[b];c.classList.toggle("badge-primary");c.classList.toggle("selected-tag");c.classList.toggle("badge-light")}app.selectedTags=[]}function updateTagDisplay(a){var b=!1;if(a||app.userID)b=!0;"My Tags"===sessionStorage.getItem("tags")&&b?displayMyTags(b):displayAllTags(b)}
function displayAllTags(a){a&&(0===document.getElementById("tags-toggle").innerHTML.length?document.getElementById("tags-toggle").innerHTML='<img src="/images/toggle_on.png" id="show-all-tags" class="toggle-switch" style="height:22px;margin-left:10px;"><img src="/images/toggle_off.png" id="show-my-tags" class="hide_me toggle-switch" style="height:22px;margin-left:10px;">':(document.getElementById("show-my-tags").classList.add("hide_me"),document.getElementById("show-all-tags").classList.remove("hide_me")));
showClass("other-tag");document.getElementById("tag-title-modifier").innerText="all users";removeSelectedElement(".no-all-tags");removeSelectedElement(".no-my-tags");0===document.getElementsByClassName("album-tag").length&&(document.getElementById("current-tags").innerHTML='<div class="no-all-tags text-primary text-center"><small>There are currently no tags for this album. Click "Add tags" below to get started!</small></div>');a&&document.getElementById("show-all-tags").addEventListener("click",function(){sessionStorage.setItem("tags",
"My Tags");updateTagDisplay(a)})}
function displayMyTags(a){0===document.getElementById("tags-toggle").innerHTML.length?document.getElementById("tags-toggle").innerHTML='<img src="/images/toggle_off.png" id="show-my-tags" class="toggle-switch" style="height:22px;margin-left:10px;"><img src="/images/toggle_on.png" id="show-all-tags" class="hide_me toggle-switch" style="height:22px;margin-left:10px;">':(document.getElementById("show-all-tags").classList.add("hide_me"),document.getElementById("show-my-tags").classList.remove("hide_me"));showClass("my-tag");
hideClass("other-tag");document.getElementById("tag-title-modifier").innerText="you";removeSelectedElement(".no-all-tags");removeSelectedElement(".no-my-tags");0===document.getElementsByClassName("my-tag").length&&document.getElementById("current-tags").appendChild(stringToNode('<div class="no-my-tags text-primary text-center"><small>You have not created any tags for this album. Click "Add tags" below to get started!</small></div>'));document.getElementById("show-my-tags").addEventListener("click",
function(){sessionStorage.setItem("tags","All Tags");updateTagDisplay(a)})}document.getElementById("tag-update-button").addEventListener("click",function(){(new Modal(document.getElementById("updateTagModal"))).show()});document.getElementById("connection-update-button").addEventListener("click",function(){(new Modal(document.getElementById("updateConnectionModal"))).show()});document.getElementById("list-update-button").addEventListener("click",function(){(new Modal(document.getElementById("updateListModal"))).show()});
addClassEventListener("page-info-button","click",function(){(new Modal(document.getElementById("pageInfoModal"))).show()});document.getElementById("new-list-title").addEventListener("keyup",function(a){13===a.keyCode&&document.getElementById("add-to-new-list-button").click()});document.getElementById("new-display-name").addEventListener("keyup",function(a){13===a.keyCode&&document.getElementById("add-to-new-list-button").click()});
document.getElementById("list-options").addEventListener("keyup",function(a){13===a.keyCode&&document.getElementById("add-to-list-button").click()});for(var infoCardTabs=document.querySelectorAll("#info-card .nav-link"),i=0;i<infoCardTabs.length;i++)infoCardTabs[i].addEventListener("click",function(){event.preventDefault();toggleActiveInfoTab(this.id)});
document.getElementById("tag-search-button").addEventListener("click",function(a){a.preventDefault();0<app.selectedTags.length?(a=new URL(document.location),a.pathname="/list",a.searchParams.set("type","tagsearch"),a.searchParams.set("search",app.selectedTags),window.location=a.href):alert("Select one or more tags to preform a tag search")});document.getElementById("clear-tag-button").addEventListener("click",function(a){a.preventDefault();clearTagArray()});
document.getElementById("add-tag-button").addEventListener("click",addTag);document.getElementById("add-tag-input").addEventListener("keyup",function(a){13===a.keyCode&&document.getElementById("add-tag-button").click()});document.getElementById("custom-genre-checkbox").addEventListener("keyup",function(a){13===a.keyCode&&document.getElementById("add-tag-button").click()});
document.getElementById("custom-genre-checkbox-text").addEventListener("click",function(){document.getElementById("custom-genre-checkbox").click();document.getElementById("custom-genre-checkbox").select()});
document.getElementById("add-connection-button").addEventListener("click",function(){var a=document.getElementById("add-connection-input").value.trim();removeSelectedElement("#no-results-message");document.getElementById("connection-search-results").innerHTML="";document.getElementById("connection-loader").classList.remove("hide_me");executeSearch(a,"connection")});document.getElementById("add-connection-input").addEventListener("keyup",function(a){13===a.keyCode&&document.getElementById("add-connection-button").click()});
document.getElementById("add-to-list-button").addEventListener("click",function(){var a=document.getElementById("list-options");a=a[a.selectedIndex].value;if("&#9825; My Favorites"===a)return addToFavorites();"Add to a list..."!==a&&addToList(a)});
document.getElementById("add-to-new-list-button").addEventListener("click",function(){var a=document.getElementById("new-list-title").value.trim(),b=document.getElementById("new-display-name").value.trim()||"Unknown";if(!a)return alert("All lists require a title!");if(a.includes("<")&&a.includes(">")||a.includes(".")||a.includes("{")||a.includes("}")||b.includes("<")&&b.includes(">")||b.includes(".")||b.includes("{")||b.includes("}"))return document.getElementById("new-list-title").value="",alert("Some characters are not allowed in tags, sorry!");
if("MY FAVORITES"===a.toUpperCase())return document.getElementById("new-list-title").value="",alert("'My Favorites' is a reserved list name. Give the existing 'My Favorites' functionality a shot or choose a different title.");if(60<a.length)return alert("List titles must be shorter than 60 characters in length.");if(30<b.length)return alert("Display names must be shorter than 30 characters in length.");addToNewList(escapeHtml(a),escapeHtml(b));document.getElementById("new-display-name").value="";
document.getElementById("new-list-title").value=""});document.addEventListener("DOMContentLoaded",function(){var a=!1;"ontouchstart"in document.documentElement&&(a=!0);a&&(a=document.getElementById("connection-search-results"),a.style.paddingBottom="0px",a.style.overflowX="scroll")});
function userIsLoggedIn(){hideClass("hide_when_logged_in");showClass("hide_when_logged_out");document.getElementById("full_menu_login_logout_container").classList.remove("hide_me");document.getElementById("login_button").classList.add("hide_me");document.getElementById("full_menu_login_button").classList.add("hide_me");document.getElementById("logout_button").classList.remove("hide_me");document.getElementById("full_menu_logout_button").classList.remove("hide_me");hideClass("info-card-login-button");
document.getElementById("tag-update-button").classList.remove("hide_me");document.getElementById("connection-update-button").classList.remove("hide_me");document.getElementById("list-update-button").classList.remove("hide_me");getAlbumDetails(!0)}
function userIsLoggedOut(){hideClass("hide_when_logged_out");showClass("hide_when_logged_in");document.getElementById("full_menu_login_logout_container").classList.remove("hide_me");document.getElementById("login_button").classList.remove("hide_me");document.getElementById("full_menu_login_button").classList.remove("hide_me");document.getElementById("logout_button").classList.add("hide_me");document.getElementById("full_menu_logout_button").classList.add("hide_me");showClass("info-card-login-button");
document.getElementById("tag-update-button").classList.add("hide_me");document.getElementById("connection-update-button").classList.add("hide_me");document.getElementById("list-update-button").classList.add("hide_me");getAlbumDetails(!1)}var config={apiKey:"AIzaSyAoadL6l7wVMmMcjqqa09_ayEC8zwnTyrc",authDomain:"album-tags-v1d1.firebaseapp.com",projectId:"album-tags-v1d1"},defaultApp=firebase.initializeApp(config);
firebase.auth().onAuthStateChanged(function(a){a&&(app.userID=firebase.auth().currentUser.uid,userIsLoggedIn());a||(app.userID=!1,userIsLoggedOut())});function logIn(){firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(function(){var a=new firebase.auth.GoogleAuthProvider;return firebase.auth().signInWithPopup(a)}).then(function(a){app.userID=user.uid;userIsLoggedIn()}).catch(function(a){})}
function logOut(){firebase.auth().signOut().then(function(){location.reload()}).catch(function(a){})}document.getElementById("login_button").addEventListener("click",logIn);document.getElementById("full_menu_login_button").addEventListener("click",logIn);document.getElementById("logout_button").addEventListener("click",logOut);document.getElementById("full_menu_logout_button").addEventListener("click",logOut);addClassEventListener("info-card-login-button","click",logIn);
