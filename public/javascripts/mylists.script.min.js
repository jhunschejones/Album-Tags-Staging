var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var f=b[c];if(f===a||Object.is(f,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
function removeByID(a,b){return a.filter(function(a){return a._id!=b})}function escapeHtml(a){var b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","/":"&sol;","\\":"&#92;","{":"&#123;","}":"&#125;"};return a.replace(/[<>"'/\\{}]/g,function(a){return b[a]})}function truncate(a,b){a=a.substr(0,b-1);return a.substr(0,a.lastIndexOf(" ")).replace(/(^[,\s]+)|([,\s]+$)/g,"")+"..."}var allLists;
function getAllLists(){$.ajax({method:"GET",url:"/api/v1/list/user/"+userID,success:function(a){allLists=a;$("#main-page-loader").hide();populateAllLists()}})}function removeList(a){var b=allLists.find(function(b){return b._id===a});confirm('Are you sure you want to delete your list "'+b.title+'"? You cannot undo this operation.')&&$.ajax({method:"DELETE",url:"/api/v1/list/"+a,success:function(){allLists=removeByID(allLists,a);populateAllLists()}})}
function populateAllLists(){$("#no-lists-message").hide();$("#all-lists").html("");if(0<allLists.length){for(var a={},b=0;b<allLists.length;a={$jscomp$loop$prop$list$2:a.$jscomp$loop$prop$list$2},b++){a.$jscomp$loop$prop$list$2=allLists[b];var c=a.$jscomp$loop$prop$list$2.displayName;""===c.trim&&(c="Unknown");for(var d=[],e=0;e<a.$jscomp$loop$prop$list$2.albums.length&&4>e;e++)d.push(a.$jscomp$loop$prop$list$2.albums[e].cover.replace("{w}",130).replace("{h}",130));e=40<a.$jscomp$loop$prop$list$2.title.length?
truncate(a.$jscomp$loop$prop$list$2.title,40):a.$jscomp$loop$prop$list$2.title;d='<div class="list-image-background"><div class="row no-gutters"><div class="col"><img src="'+(d[0]||"")+'" class="list-image"></img></div><div class="col"><img src="'+(d[1]||"")+'" class="list-image"></img></div></div><div class="row no-gutters"><div class="col"><img src="'+(d[2]||"")+'" class="list-image"></img></div><div class="col"><img src="'+(d[3]||"")+'" class="list-image"></img></div></div></div>';$("#all-lists").append('<div><div id="card-'+
b+'" class="card list-card">'+d+'<div class="list-card-text"><h5 class="card-title list-title"><span class="long-list-title">'+a.$jscomp$loop$prop$list$2.title+'</span><span class="short-list-title">'+e+'</span></h5><p class="card-text text-secondary list-creator">by: '+c+'</p></div></div><span class="list-delete-button" data-list-id="'+a.$jscomp$loop$prop$list$2._id+'" data-toggle="tooltip" data-placement="right" title="Delete this list" data-trigger="hover">&#10005;</span></div>');$("#card-"+b).click(function(a){return function(b){b.preventDefault();
window.location.href="/list?type=userlist&id="+a.$jscomp$loop$prop$list$2._id}}(a))}$(".list-delete-button").on("click",function(a){a.preventDefault();removeList($(this).attr("data-list-id"))})}else $("#no-lists-message").show()}
function addToNewList(a,b){var c=!0,d=allLists.find(function(b){return b.title.toUpperCase()===a.toUpperCase()});d&&(c=confirm('You already have a list called "'+d.title+'". Choose "ok" to create a new list, "cancel" to go back.'));c&&a&&b&&$.ajax({method:"POST",url:"/api/v1/list/",contentType:"application/json",data:JSON.stringify({user:userID,displayName:b,title:a,isPrivate:!1,albums:[]}),success:function(a){a.message?alert(a.message):(allLists.push(a),populateAllLists(),$("#updateListModal").modal("hide"),
$("#new-list-title").val(""),$("#new-display-name").val(""))}})}
$("#add-new-list-button").click(function(a){a.preventDefault();a=document.getElementById("new-list-title").value.trim();var b=document.getElementById("new-display-name").value.trim()||"Unknown";a?a.includes("<")&&a.includes(">")||a.includes(".")||a.includes("{")||a.includes("}")?(alert("Some characters are not allowed in tags, sorry!"),$("#new-list-title").val("")):b.includes("<")&&b.includes(">")||b.includes(".")||b.includes("{")||b.includes("}")?(alert("Some characters are not allowed in tags, sorry!"),
$("#new-display-name").val("")):60<a.length?alert("List titles must be shorter than 60 characters in length."):30<b.length?alert("Display names must be shorter than 30 characters in length."):(addToNewList(escapeHtml(a),escapeHtml(b)),document.getElementById("new-display-name").value="",document.getElementById("new-list-title").value=""):alert("All lists require a title!")});$("#new-list-title").keyup(function(a){13===a.keyCode&&$("#add-new-list-button").click()});
$("#new-display-name").keyup(function(a){13===a.keyCode&&$("#add-new-list-button").click()});var config={apiKey:"AIzaSyAoadL6l7wVMmMcjqqa09_ayEC8zwnTyrc",authDomain:"album-tags-v1d1.firebaseapp.com",projectId:"album-tags-v1d1"},defaultApp=firebase.initializeApp(config);
firebase.auth().onAuthStateChanged(function(a){a?(userID=firebase.auth().currentUser.uid,getAllLists(),$("#full_menu_login_logout_container").show(),$("#login_button").hide(),$("#full_menu_login_button").hide(),$("#logout_button").show(),$("#full_menu_logout_button").show(),$("#page-title").show(),$("#login-message").hide(),$("#all-lists").show(),$("#launch-new-list-modal-button").show()):($("#full_menu_login_logout_container").show(),$("#login_button").show(),$("#full_menu_login_button").show(),
$("#logout_button").hide(),$("#full_menu_logout_button").hide(),$("#main-page-loader").hide(),$("#login-message").show(),$("#page-title").hide(),$("#all-lists").hide(),$("#launch-new-list-modal-button").hide())});var userID;
function logIn(){firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(function(){var a=new firebase.auth.GoogleAuthProvider;return firebase.auth().signInWithPopup(a)}).then(function(a){userID=user.uid;getAllLists();$("#login-message").hide();$("#page-title").show();$("#all-lists").show();$("#launch-new-list-modal-button").show();$("#full_menu_login_logout_container").show();$("#login_button").hide();$("#full_menu_login_button").hide();$("#logout_button").show();$("#full_menu_logout_button").show()}).catch(function(a){})}
function logOut(){firebase.auth().signOut().then(function(){$("#full_menu_login_logout_container").show();$("#login_button").show();$("#full_menu_login_button").show();$("#logout_button").hide();$("#full_menu_logout_button").hide();$("#login-message").show();$("#page-title").hide();$("#all-lists").hide();$("#launch-new-list-modal-button").hide()}).catch(function(a){})}
var loginButton=document.getElementById("login_button"),loginButton2=document.getElementById("full_menu_login_button"),logoutButton=document.getElementById("logout_button"),logoutButton2=document.getElementById("full_menu_logout_button");loginButton.addEventListener("click",logIn);loginButton2.addEventListener("click",logIn);logoutButton.addEventListener("click",logOut);logoutButton2.addEventListener("click",logOut);$(".login_button").on("click",logIn);
